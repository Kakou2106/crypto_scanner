name: Quantum Scanner 24/7

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  scan:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: Install core dependencies only
        run: |
          pip install python-dotenv aiohttp requests beautifulsoup4 lxml web3 pandas numpy aiosqlite python-telegram-bot loguru python-dateutil pytz
          echo "âœ… DÃ©pendances principales installÃ©es"
      
      - name: Create directories
        run: mkdir -p logs results
      
      - name: Run Scanner
        run: python main.py
      
      - name: Notify Telegram
        if: always()
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            {{ if success() }}
            âœ… Quantum Scan #${{ github.run_number }} RÃ‰USSI
            ğŸ“Š Scan terminÃ© avec succÃ¨s
            {{ else }}
            âŒ Quantum Scan #${{ github.run_number }} Ã‰CHEC
            ğŸš¨ Erreur pendant l'exÃ©cution
            {{ end }}
            ğŸ”— Voir les dÃ©tails: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
            â° Prochain scan: 6h